# INCAR全部关键词自检

### **是否理解INCAR中参数含义，将直接决定：**

> 我们能否正确设置参数从而得到合理的计算结果

INCAR文件中的参数众多，对于VASP软件使用新手来说，学习和记忆的难度都比较大。本文系统整理了INCAR中的重要参数（文章参数按排序包含了电子步、离子步参数、总体精度、动能截断、自旋极化、范德华力修正、LDA+U、电子态密度和能带等），涵盖：

> 参数作用

# **1、 ISTART**

**控制如何生成初始波函数**

0：随机生成波函数

1 ： 从WAVECAR中读取波函数，当读取失败时，会随机生成

2：读入已有波函数文件，但截断能和元胞都不能改变。

默认没有找到波函数WAVECAR，则ISTART=0，否则为1

# **2、 ICHAGE**

**控制如何生成初始电荷密度**

0：读取WAVECAR生成电荷密度，当读取失败时，通过原子电荷密度叠加生成初始电荷密度

1：从CHGCAR中的设定读取电荷密度

2：通过原子电荷密度的叠加方法，生成初始的猜测电荷密度

11：从CHGCAR读取电荷密度，且在自洽循环中保持不变，适用于非自洽循环计算，如电子态密度的计算

# **3、 ALGO**

**设置自洽迭代过程优化电子波函数的算法**

N：DAV算法，收敛性好，但速度慢

V：RMM算法，收敛性差，但速度快（比N快2~3倍）

F：以上算法的结合，综合表现与V类似

Tips：结构偏离稳定结构较多的，建议用N，接近稳定结构的，可以用V。

# **4、 EDIFF**

**自洽迭代循环收敛标准，单位为eV**

自洽迭代过程紧邻两次迭代（前后两次迭代）的系统能量的差与此标准相比。一般设置为1E-5~1E-6，意为**两次能量差小于设定的收敛标准，则自洽迭代结束，判定体系收敛**。

# **5、 NELM**

**自洽迭代循环的最大次数，通常设置为100**

有哪些应用注意事项？

过渡金属体系、带真空层的体系，设置了自旋极化的体系，此数值需要增加到200，300等。如果仍不能收敛，不建议继续提高此数值，需要尝试调整其他参数达到收敛的目标。

# **6、 IBRION**

**离子步弛豫（离子位置优化）算法**

-1：离子不懂

0：第一性原理分子动力学模拟

1：准牛顿法

2：共轭梯度法

3：阻尼分子动力学计算

5：振动频率计算，使用差分方法计算力常数和晶格振动频率

6：弹性常数计算，使用差分方法计算力常数和晶格振动频率，考虑对称性
当ISIF≥3时，VASP还可以计算弹性常数，此时需要提高平面波截断能。

额外设置：LEPSILON=.TRUE. 或者LCALCEPS=.TRUE.可计算玻恩有效电荷，压电常数和离子介电常数。

7：和5类似，但采用密度泛函微扰理论计算力常数，不考虑对称性

8：和6类似，采用密度泛函微扰理论计算力常数，考虑对称性

Tips：推荐设置值为2，如果初始结构和最终稳定结构接近，可以设置为1。

# **7、 EDIFFG**

设定**优化结构精度**

**离子步弛豫收敛标准（包含能量标准和力的标准）**

正值为系统能量变化（单位为eV），负值为原子上残余力（单位为：eV/埃）。多数情况用力的收敛标准判断离子步弛豫是否收敛

Tips：三维结构可以收敛到-0.01~ -0.03 eV/埃，低维体系可以收敛到- 0.03~0.05eV/埃。

# **8、 ICHAGE**

**最大的离子步的数目 or 分子动力学模拟步数**

当IBRION=1和2时，NSW代表最大的离子步数目

当IBRION=0时，NSW代表分子动力学模拟步数

# **9、 ISIF**

**离子步弛豫控制**

参数说明如下图：

![ISIF](https://ustc-torj.oss-cn-hangzhou.aliyuncs.com/img/image%201.png)
![ISIF](https://ustc-torj.oss-cn-hangzhou.aliyuncs.com/img/image.png)

3：全弛豫，适用于绝大多数的三维结构优化

2：为固定体积的弛豫，适用于如表面结构优化，微量掺杂体系优化

4：固定体积，但是形状可变的弛豫

**Tips：**

复杂的结构优化过程，可以分步优化，即初始只优化离子（ISIF=2）→优化晶胞（ISIF=6）→优化离子和晶胞（ISIF=3）。

# **10 、PREC** 🌟

**总体计算精度控制**

受PREC影响的参数有四类（ENCUT; NGX,NGY,NGZ; NGXF, NGYF, NGZF; ROPT） PREC=Low | Medium | High | Normal | Accurate | Single。

在一般计算中，默认选择PREC=Normal或Medium，但如果需要提高计算精度时，如声子计算

下图总结了PREC的设置值与其控制的其他参数值的关系。

![PREC](https://ustc-torj.oss-cn-hangzhou.aliyuncs.com/img/image%202.png)

**上图如何解读？**

以ENCUT为例，当INCAR文件中未设置ENCUT参数值，此时如果将PREC设置为Normal，则ENCUT将被自动设置为POTCAR（赝势文件）中最大的ENMAX对应的数值。

# **11、 ENCUT** 🌟

**平面波截断能，控制用多少平面波展开波函数（基组的大小，项数越多精度越高）**

**Tips：**推荐设置为POTCAR（赝势文件）中参数ENMAX值的1.0-1.3倍，从而兼顾计算的精度与效率。

# **12、 AMIX**

**设置自洽迭代循环中新旧电荷密度的混合比例，默认值为0.4**

自洽迭代不收敛该如何调整此参数？ 自洽迭代不收敛时，可以降低此数值,即降低新的电荷密度混入的比例。

---

# **13、 ISMEAR** 🌟

**设置展宽方法，决定如何进行电子轨道分数占据**

默认值为 1

值为：-5 -4 -3 -2 0 N(正值)

0：高斯方法(高斯展宽)，适用于导体、半导体和绝缘体，或不清楚体系的导电性质时使用。展宽由SIGMA确定。

- 5：四面体方法，适用于半导体和绝缘体

**Tips：**明确的半导体结构使用-5，其他绝大部分情况使用0。注意设置-5时K点网格个数要大于5。

# **14、 SIGMA**

**展宽的宽度，与ISMEAR联用，单位为eV，默认值为0.2**

建议：

在金属体系中，适用ISMEAR=1或2，SIGMA=0.2左右；

在半导体或绝缘体中使用ISMEAR=0，SIGMA=0.05左右；

在计算态密度时，使用ISMEAR=-5，同时设置不同的SIGMA。

![SIGMA](https://ustc-torj.oss-cn-hangzhou.aliyuncs.com/img/image%203.png)

## ISMEAR和SIGMA决定在做布里渊积分时如何计算分布函数

---

# **15、 ISPIN**

**是否考虑电子自旋极化。默认值为1**

1：非自旋极化，即每个轨道上自旋向上和自旋向下的电子数量相等。适用于非磁性体系。

2：自旋极化。适用于磁性体系，如铁磁，反铁磁材料。

如果做非共线磁结构计算 (**LNONCOLLINEAR=.TRUE.**)，则不需要设置ISPIN参数。

# **16、 MAGMOM**

**对于磁性材料，设置初始原子磁矩**

默认值是每个原子的磁矩均为1

对于含有d、f轨道的原子，需根据原子核外电子排布情况设置相应的数值

可以设置每个原子初始磁矩方向，正值为自旋向上，负值为自旋向下。

# **17、 LDA+U**

**Hubbard U模型，描述电子强关联能**

参数组为：LDAU、LDAUL、LDAUU、LDAUJ

LDAU=.T. 使用LDA+U功能

LDAUL=-1/1/2/3 分别对应不加U和p、d、f轨道加U

LDAUU、LDAUJ 分别设置U和J值

**Tips：**LDA、GGA等[交换相关](https://zhida.zhihu.com/search?q=%E4%BA%A4%E6%8D%A2%E7%9B%B8%E5%85%B3&zhida_source=entity&is_preview=1)泛函通常会低估带隙，通过设置此参数可以得到更接近于真实值的带隙计算结果。

# **18、 IVDW**

**范德华力计算方法，在DFT能量计算基础上增加范德华力修正**

10：DFT-D2方法

11：DFT-D3方法

推荐首选更新的DFT-D3方法。

哪些体系需要使用此参数呢？

在计算表面吸附(物理吸附) ; [弱相互作用](https://zhida.zhihu.com/search?q=%E5%BC%B1%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8&zhida_source=entity&is_preview=1)占体系能量比例较大的体系,如分子晶体、层状[结构体系](https://zhida.zhihu.com/search?q=%E7%BB%93%E6%9E%84%E4%BD%93%E7%B3%BB&zhida_source=entity&is_preview=1)时,要使用此参数。

# **19、 LUSE_VDW**

**范德华力计算方法**

与IVDW的计算方法不同，此种方法将修改DFT内的能量计算。包含vdW-DF，optPBE-vdW, optB88-vdW, optB88b-vdW, vdw-DF2。

# **20 、NELECT**

**指定体系总电子数目**

通常不用修改，默认值结合POSCAR和POTCAR自动计算体系[价电子数](https://zhida.zhihu.com/search?q=%E4%BB%B7%E7%94%B5%E5%AD%90%E6%95%B0&zhida_source=entity&is_preview=1)。 若要实现体系带电，则可控制此参数实现，在总电子数目基础上减少n个电子，则体系带n个电荷正电，反之是带负电。

**Tips：**无法将电荷指定在某个特定原子上

# **21、 LWAVE/LCHARG**

控制是否输出波函数和电荷密度

.T.: 写波函数和电荷密度

.F.: 不写波函数和电荷密度

# **22、 NEDOS**

**态密度数据点个数**

通常设置1000-3000

# **23、 LORBIT**

**总态密度投影**

10：投影到s、p、d、f轨道

11：投影到s、px、py、pz.....轨道

# **24、 RWIGS**

**原子Wigner-Seitz半径，控制分态密度强度**

# **25 、NBANDS**

**总能带数**

通常计算无需修改参数。 Tips：特别注意，光学性质计算设置为默认值的3~4倍

# 26、LREAL

决定投影算符在实空间还说在倒空间计算。

建议在做高精度计算时，设置LREAL=.FALSE. ，否则在超过20个原子系统中可设置LREAL=Auto

默认值：LREAL=.FALSE.

# 27、KSPACING和KGAMMA

# 28、NBANDS

设置能带数目

**通常不用设置**，VASP会根据元胞中的电子数和粒子数决定总的能带数。

但是在有的计算中，如计算光学性质时，需要手动增加能带数。

# 29、PSTRESS

外加应力，单位为：kbar（1 kbar=0.1 GPa）

---

# 范德瓦尔斯相互作用：

# 30、IVDW

增加范德瓦尔斯相互作用

IVDW=0，表示不加

IVDW＞0，可以选择不同的方案，详情见VASP手册

# 31、LUSE_VDW

另一类范德瓦尔斯相互作用方案

---